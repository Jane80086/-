<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.system.repository.EnterpriseMapper">

    <!-- 基本的CRUD操作 -->
    <select id="selectById" parameterType="java.lang.Long" resultType="com.system.entity.Enterprise">
        SELECT * FROM enterprise WHERE enterprise_id = #{enterpriseId}
    </select>

    <select id="selectList" resultType="com.system.entity.Enterprise">
        SELECT * FROM enterprise
    </select>

    <insert id="insert" parameterType="com.system.entity.Enterprise" useGeneratedKeys="true" keyProperty="enterpriseId">
        INSERT INTO enterprise (
            enterprise_id, enterprise_name, credit_code, legal_representative, registered_capital, 
            establishment_date, register_address, business_scope, business_term, 
            enterprise_status, enterprise_type, registration_authority, 
            registration_date, approval_date, create_time, update_time
        )
        VALUES (
            #{enterpriseId}, #{enterpriseName}, #{creditCode}, #{legalRepresentative}, #{registeredCapital},
            #{establishmentDate}, #{registerAddress}, #{businessScope}, #{businessTerm},
            #{enterpriseStatus}, #{enterpriseType}, #{registrationAuthority},
            #{registrationDate}, #{approvalDate}, #{createTime}, #{updateTime}
        )
    </insert>

    <update id="updateById" parameterType="com.system.entity.Enterprise">
        UPDATE enterprise 
        SET enterprise_name = #{enterpriseName}, credit_code = #{creditCode}, legal_representative = #{legalRepresentative}, registered_capital = #{registeredCapital}, establishment_date = #{establishmentDate}, register_address = #{registerAddress}, business_scope = #{businessScope}, business_term = #{businessTerm}, enterprise_status = #{enterpriseStatus}, enterprise_type = #{enterpriseType}, registration_authority = #{registrationAuthority}, registration_date = #{registrationDate}, approval_date = #{approvalDate}, update_time = #{updateTime}
        WHERE enterprise_id = #{enterpriseId}
    </update>

    <delete id="deleteById" parameterType="java.lang.Long">
        DELETE FROM enterprise WHERE enterprise_id = #{enterpriseId}
    </delete>

    <!-- 分页+条件筛选企业列表 -->
    <select id="selectEnterpriseListPaged" resultType="com.system.entity.Enterprise">
        SELECT * FROM enterprise
        <where>
            <if test="enterpriseName != null and enterpriseName != ''">
                AND enterprise_name LIKE CONCAT('%', #{enterpriseName}, '%')
            </if>
            <if test="creditCode != null and creditCode != ''">
                AND credit_code LIKE CONCAT('%', #{creditCode}, '%')
            </if>
            <if test="status != null and status != ''">
                AND enterprise_status = #{status}
            </if>
        </where>
        LIMIT #{offset}, #{size}
    </select>

    <select id="countEnterpriseListPaged" resultType="int">
        SELECT COUNT(*) FROM enterprise
        <where>
            <if test="enterpriseName != null and enterpriseName != ''">
                AND enterprise_name LIKE CONCAT('%', #{enterpriseName}, '%')
            </if>
            <if test="creditCode != null and creditCode != ''">
                AND credit_code LIKE CONCAT('%', #{creditCode}, '%')
            </if>
            <if test="status != null and status != ''">
                AND enterprise_status = #{status}
            </if>
        </where>
    </select>

</mapper>
